{% extends "base.html" %}
{% block title %} Cell Info {% endblock title %}
{% block content %}

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load("current", {packages:["corechart"]});
  google.charts.setOnLoadCallback(drawCharts);

  function drawChart(title, json, elem) {
    const data = google.visualization.arrayToDataTable(json);
    const options = {
      title: title,
      pieHole: 0.4,
    };
    const chart = new google.visualization.PieChart(elem);
    chart.draw(data, options);
  }
  function drawCharts() {
    charts_container = document.getElementById('charts_container');
    {% for k, v in charts.items() %}
        elem = document.createElement('div');
        elem.setAttribute("class", "card");
        elem.setAttribute("style", "width: 100%; height: 400px;");
        charts_container.appendChild(elem);
        drawChart("{{k}}", {{v|tojson}}, elem);
    {% endfor %}
  }
</script>

<div class="card-columns"  id="main_panels_container" style="padding: 5px;">
    <div class="card" style="width: 100%;">
        <div class="card-header" style="color: purple;">
          Cell Info
        </div>
        <div class="body">
            <table class="table">
              <tbody>
                {% for k, v in cell_attributes.items() %}
                    <tr>
                      <td>{{k|safe}}</td>
                      <td>{{v|safe}}</td>
                    </tr>
                {% endfor %}
              </tbody>
            </table>
        </div>
    </div>
    {% if load_connections %}
    <div class="card" style="width: 100%; height: 450px;">
        <div class="card-header" style="color: purple;">
            Connected Cells
        </div>
        <iframe style="width: 100%; height: 100%;" src="{{url_for('connections', root_ids=cell_id, log_request=0)}}" title="connectivity" loading="lazy"></iframe>
    </div>
    {% endif %}

    <div class="card" style="width: 100%; height: 450px;">
        <div class="card-header" style="color: purple;">
            Skeleton
        </div>
        <iframe style="width: 100%; height: 100%;" src="{{url_for('flywire_url', root_id=cell_id, log_request=0)}}" title="neuroglancer" loading="lazy"></iframe>
    </div>
</div>

<div class="card" style="width: 100%;">
    <div class="card-header" style="color: purple;">
      Related Cells
    </div>
    <div class="body">
        <table class="table">
          <tbody>
            {% for k, v in related_cells.items() %}
                <tr>
                  <td>{{k|safe}}</td>
                  <td>{{v|safe}}</td>
                </tr>
            {% endfor %}
          </tbody>
        </table>
    </div>
</div>

<div class="card-columns"  id="charts_container" style="padding: 5px;">
</div>

{% endblock content %}