{% extends "base.html" %}
{% block title %}
Neuropil Explorer
{% endblock title %}

{% macro card(hemisphere) %}
<div class="card">
  <div class="card-body">
    <h5 class="card-title">{{ hemisphere|capitalize }} Hemisphere</h5>
    <ul>
      {% for category in regions[hemisphere] %}
      <li>
        <a href="/app/neuropils?selected={{category['regions'] | map(attribute='id') | list | join(',')}}">
          {{category["name"]}}
        </a>
      </li>
      <ul>
        {% for region in category["regions"] %}
        <li>
          <a href="/app/neuropils?selected={{region["id"]}}">
            {{region["description"]}}
          </a>
        </li>
        {% endfor %}
      </ul>
      {% endfor %}
    </ul>
  </div>
</div>
{% endmacro %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    {{ card("Left") }}
    {{ card("Center") }}
    {{ card("Right") }}
 {% if selected %}
    <div class="card">
    <div class="card-body">
    
      <iframe
        id="neuroglancer"
        style="width: 500px; height: 500px"
        title="neuroglancer"
        loading="lazy"
        src="/app/flywire_neuropil_url?selected={{selected}}"
      ></iframe>
  
      <h5>Search For Neurons:</h5>
      
      <p>
        
        <a
          href="/app/search?filter_string=output_neuropil+%7Bin%7D+{{selected}}"
          className="btn btn-primary"
        >
          With this region as output
        </a>
      </p>
      <p>
        <a
          href="/app/search?filter_string=input_neuropil+%7Bin%7D+{{selected}}"
          classname="btn btn-primary"
        >
          With this region as input
        </a>
      </p>
      <h5>See Neuron Stats</h5>
      <p>
        <a
          href="/app/stats?filter_string=input_neuropil+%7Bin%7D+{{selected}}"
          className="btn btn-primary"
        >
          With this region as output
        </a>
      </p>
      <p>
        <a
          href="/app/stats?filter_string=input_neuropil+%7Bin%7D+{{selected}}"
        >
          With this region as input
        </a>
      </p>
      
</div>
    </div>
    {% endif %}
  </div>

  <script type="text/javascript">
    console.log({{regions| tojson}});
  </script>
{% endblock content %}
